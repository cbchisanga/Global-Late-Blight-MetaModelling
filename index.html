<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Global late blight (meta)modelling by adamhsparks</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Global late blight (meta)modelling</h1>
      <h2 class="project-tagline">R Scripts and supporting data for creating metamodels,  as published in Ecosphere, and using them to generate global estimates of potato late blight risk based on climate data as published in Global Change Biology.</h2>
      <a href="https://github.com/adamhsparks/Global-Late-Blight-MetaModelling" class="btn">View on GitHub</a>
      <a href="https://github.com/adamhsparks/Global-Late-Blight-MetaModelling/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/adamhsparks/Global-Late-Blight-MetaModelling/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="global-late-blight-metamodelling" class="anchor" href="#global-late-blight-metamodelling" aria-hidden="true"><span class="octicon octicon-link"></span></a>Global-Late-Blight-(Meta)Modelling</h1>

<h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p>This repository hosts R Scripts and the data necessary for reproducing my work with metamodels used to map the global risk of potato late blight. This is done using blight units based on the SimCast model modified by <a href="http://grunwaldlab.cgrb.oregonstate.edu/potato-late-blight-management-toluca-valley-field-validation-simcast-modified-cultivars-high-field">Grünwald et al. (2002)</a>. Other scripts include tools to predict growing seasons using Ecocrop and estimating global late blight severity using monthly time-step weather data to generate maps of potato late blight risk.</p>

<p>The metamodelling approach can be found in <a href="http://www.esajournals.org/doi/pdf/10.1890/es11-00128.1">Sparks, A. H., Forbes, G. A., Hijmans, R. J., &amp; Garrett, K. A. (2011). A metamodeling framework for extending the application domain of process-based ecological models. Ecosphere, 2(8), art90. doi:10.1890/ES11-00128.1</a>.</p>

<p>The study for which these models were developed can be found in <a href="http://onlinelibrary.wiley.com/doi/10.1111/gcb.12587/abstract">Sparks, A. H., Forbes, G. A, Hijmans, R. J., &amp; Garrett K. A. (2014). Climate change may have limited effect on global risk of potato late blight. Global Change Biology, doi:10.1111/gcb.12587</a>.</p>

<p>While the first manuscript may be completely replicated, this repository is not a perfect replication of the second manuscipt, Sparks et al. (2014), but is a reproduction using freely available data that can be downloaded from the web as of the time of publishing (Jan 2016). It is intended for the user to be able to reproduce the analysis that I have done and undertake their own efforts with their own data.</p>

<p>Following H. Wickham's style guide, the folders (in bold) and scripts are numbered in the consecutive order in which they should be run. I have already provided blight unit predictions based on the HUSWO data, so 01 - Models/01 - SimCast_Blight_Units.R is not necessary to run and is provided for information purposes here only the script is functional if the user has HUSWO data from 1990-1995. After that, all other scripts are fully usable as provided here.</p>

<p>The scripts can easily be run on a modest machine, it only takes a few hours to complete on an Early 2015 MacBook with the Core M 1.3 processor. A reasonably fast Internet connection will assist since there is a good deal of data to be downloaded from various sources. FAO data is used to provide information on the top producing countries, the most recent year provided is used by default.</p>

<p>For RStudio users, there is an RProj file included that makes things easier. For all others, I'll assume you know what you're doing and how to set your working directory accordingly with the file structure contained herein.</p>

<p>To cite this code, please use this DOI: 10.6084/m9.figshare.1066124</p>

<p>Happy modelling!</p>

<h2>
<a id="directory-structure" class="anchor" href="#directory-structure" aria-hidden="true"><span class="octicon octicon-link"></span></a>Directory structure</h2>

<ul>
<li>
<p><strong>01 - Models</strong> - Contains the scripts for the models used in this project</p>

<ul>
<li>01 - SimCast_Blight_Units.R - The blight unit portion of the SimCast model, as described in <a href="http://grunwaldlab.cgrb.oregonstate.edu/potato-late-blight-management-toluca-valley-field-validation-simcast-modified-cultivars-high-field">Grünwald et al. 2002</a>
</li>
<li>02 - SimCastMeta.R - The metamodel, as described in <a href="http://www.esajournals.org/doi/pdf/10.1890/es11-00128.1">Sparks et al. 2011</a>
</li>
<li>03 - EcoCrop CRU CL2.0 Potato Growing Seasons.R - Downloads CRU CL2.0 data from CRU <a href="http://www.cru.uea.ac.uk/cru/data/hrg/tmc/new_et_al_10minute_climate_CR.pdf">New et al. 2000</a>
and MIRCA2000 from Uni Frankfurt, MIRCA2000, <a href="http://www2.uni-frankfurt.de/45218023/MIRCA?legacy_request=1">(Portman et al. 2000)</a>, to generate maps of potato planting dates, output files are found in "Cache/Planting Seasons"</li>
<li>04 - EcoCrop CRU A2 Scenario Potato Growing Seasons.R - Downloads A2 Climate data from my Figshare
and MIRCA2000 from Uni Frankfurt, MIRCA2000, <a href="http://www2.uni-frankfurt.de/45218023/MIRCA?legacy_request=1">(Portman et al. 2000)</a>, to generate maps of potato planting dates, output files are found in "Cache/Planting Seasons"</li>
</ul>
</li>
<li>
<p><strong>02 - Analysis</strong> - Contains scripts that are used for analysis</p>

<ul>
<li>01 - CRU CL2.0 SimCastMeta_Global_Late_Blight_Risk.R Script that uses SimCastMeta with CRU CL2.0 climate data generating blight unit predictions as raster objects</li>
<li>02 - A2 2050 SimCastMeta_Global_Late_Blight_Risk.R Script that uses SimCastMeta with A2 ensemble climate data generating blight unit predictions as raster objects</li>
<li>03 - Extract_Visualise_Risk_by_Country.R - Script that downloads FAO production data and Natural Earth cultural 1:50 shape files to extract and visualise countries risk rank</li>
</ul>
</li>
<li>
<p><strong>Cache</strong> - Contains supporting data that has been modified from original format in some meaningful way.</p>

<ul>
<li>
<strong>Blight Units</strong> - Data necessary for creating the models</li>
<li>
<strong>Global Blight Risk Maps</strong> - Output from the SimCastMeta model, when run using the CRU CL2.0 data</li>
<li>
<strong>Look Up Tables</strong> - Output from the metamodels as a Temperature/Relative Humidity/Blight Unit value table. This is useful for a GIS or other application where you don't need to use R. Values start at 70% RH and go to 100% RH in 1Âº C increments up to 35Âº C, anything below 70% RH or above 35º  C in metamodel can be assumed to be zero blight units.

<ul>
<li>resistant_daily_gam.txt - Look up table values for a resistant potato cultivar, daily time-step</li>
<li>resistant_monthly_gam.txt - Look up table values for a resistant potato cultivar, daily time-step</li>
<li>susceptible_daily_gam.txt - Look up table values for a resistant potato cultivar, daily time-step</li>
<li>susceptible_monthly_gam.txt - Look up table values for a resistant potato cultivar, daily time-step</li>
</ul>
</li>
<li>
<strong>Planting Seasons</strong> - Geotiff files with EcoCrop model output of the predicted month where planting results in the highest 90 day yield</li>
<li>CRU_CL20_Combined.tif - Geotiff file of combined rainfed and irrigated potato planting dates based on CRU CL2.0 data using EcoCrop to predict the month for crop establishment that results in the highest yield, generated using the script, 03 - EcoCrop CRU CL2.0 Potato Growing Seasons.R, found in the Models directory</li>
<li>CRU_CL20_PIR.tif - R raster package native file of irrigated potato planting dates based on CRU CL2.0 data using EcoCrop to predict the month for crop establishment that results in the highest yield, generated using the script, 03 - EcoCrop CRU CL2.0 Potato Growing Seasons.R, found in the Models directory</li>
<li>CRU_CL20_PRF.tif - R raster package native file of rainfed potato planting dates based on CRU CL2.0 data using EcoCrop to predict the month for crop establishment that results in the highest yield, generated using the script,03 - EcoCrop CRU CL2.0 Potato Growing Seasons.R, found in the Models directory</li>
<li>A2_2050_Combined.tif - Geotiff file of combined rainfed and irrigated potato planting dates based on CRU CL2.0 data using EcoCrop to predict the month for crop establishment that results in the highest yield, generated using the script, 04 - EcoCrop CRU A2 Scenario Potato Growing Seasons.R, found in the Models directory</li>
<li>A2_2050_PIR.tif - R raster package native file of irrigated potato planting dates based on CRU CL2.0 data using EcoCrop to predict the month for crop establishment that results in the highest yield, generated using the script, 04 - EcoCrop CRU A2 Scenario Potato Growing Seasons.R, found in the Models directory</li>
<li>A2_2050_PRF.tif - R raster package native file of rainfed potato planting dates based on CRU CL2.0 data using EcoCrop to predict the month for crop establishment that results in the highest yield, generated using the script, 04 - EcoCrop CRU A2 Scenario Potato Growing Seasons.R, found in the Models directory</li>
</ul>
</li>
<li><p><strong>Predictions</strong> - Geotiff files of SimCastMeta predictions for each of 12 months globally</p></li>
<li><p><strong>Data</strong> - Contains supporting data that is unmodified, nothing should be upload here via git. It is for downloading and storage only while in use and for storage on your local machine to save time running scripts in the future.</p></li>
<li>
<p><strong>Functions</strong> - Contains scripts with functions that are used across several scripts for sharing</p>

<ul>
<li>create_stack.R - Function used to create raster stack objects of the downloaded CRU CL2.0 data</li>
<li>Get_A2_Data.R - Function used to download A2 climate data from my Figshare account and import into R for use.</li>
<li>Get_CRU_20_Data.R - Function used to download CRU CL2.0 data and import it into R for use.</li>
<li>Get_MIRCA.R - Script used to download MIRCA2000 datasets, unzip and create native R raster objects from them</li>
<li>run_ecocrop.R - Function used to run the EcoCrop model to predict planting dates for use with SimCastMeta</li>
</ul>
</li>
</ul>

<h2>
<a id="acknowledgements" class="anchor" href="#acknowledgements" aria-hidden="true"><span class="octicon octicon-link"></span></a>Acknowledgements</h2>

<p>We appreciate support by the USAID through the [International Potato Center (CIP)[(<a href="http://cipotato.org/">http://cipotato.org/</a>)], by NSF grant EF-0525712 as part of the joint NSF-NIH Ecology of Infectious Disease program, by NSF Grant DEB-0516046, by the USAID for the SANREM CRSP under terms of Cooperative Agreement Award No. EPP-A-00-04-00013-00 to the OIRED at Virginia Tech, by the <a href="http://www.cgiar.org/">CGIAR</a> <a href="http://www.rtb.cgiar.org/">Research Programs Roots, Tubers and Bananas (RTB)</a>, and <a href="http://ccafs.cgiar.org/">Climate Change, Agriculture and Food Security (CCAFS)</a>.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/adamhsparks/Global-Late-Blight-MetaModelling">Global late blight (meta)modelling</a> is maintained by <a href="https://github.com/adamhsparks">adamhsparks</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
